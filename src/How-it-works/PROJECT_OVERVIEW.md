# نظرة شاملة وعميقة على مشروع "المائدة"

## 1. ما هو مشروع "المائدة"؟

"المائدة" هو نظام ويب متكامل ومتقدم، تم تصميمه ليكون الذراع اليمنى لإدارة المطاعم الحديثة. هو ليس مجرد تطبيق، بل هو منظومة تشغيلية ذكية تهدف إلى أتمتة العمليات اليومية، تقليل الأخطاء البشرية، وتقديم تجربة استثنائية لكل من موظفي المطعم وزبائنه. الميزة الأساسية التي تميز "المائدة" هي قدرته على العمل بسلاسة في وضعي الاتصال بالإنترنت وعدم الاتصال، مع ضمان مزامنة البيانات تلقائياً.

---

## 2. الهدف الأساسي من المشروع

الهدف من "المائدة" يتجاوز إدارة الطلبات، ويسعى إلى تحقيق ثلاثة أهداف استراتيجية:

*   **الكفاءة التشغيلية القصوى:** تبسيط وأتمتة العمليات المعقدة، بدءاً من تلقي الطلب من الزبون، مروراً بتحضيره في المطبخ، وانتهاءً بإتمام عملية الدفع، مما يوفر الوقت ويقلل من الأخطاء.
*   **تجربة زبون لا تُنسى:** تقديم أدوات تفاعلية وحديثة للزبون، مثل قائمة الطعام الرقمية والتفاعلية، مما يجعل تجربة الطلب أكثر متعة وسهولة.
*   **صناعة قرارات مبنية على البيانات:** تزويد إدارة المطعم بتقارير وتحليلات دقيقة حول المبيعات، المصاريف، وأداء الأصناف، مما يساعد على اتخاذ قرارات مدروسة لتحسين الربحية.

---

## 3. كيف يعمل المشروع؟ (آلية العمل)

يعتمد "المائدة" على تقسيم الواجهات حسب دور المستخدم، وعلى بنية بيانات ذكية تضمن استمرارية العمل.

### أ. البنية التحتية للبيانات: العمل دون اتصال أولاً (Offline-First)

هذه هي الركيزة الأساسية للنظام:
1.  **قاعدة البيانات السحابية (Supabase):** هي المصدر الرئيسي والموثوق للبيانات.
2.  **قاعدة البيانات المحلية (IndexedDB):** عند تشغيل التطبيق، يتم تحميل نسخة من البيانات الأساسية (الطاولات، الطلبات، القائمة) من Supabase وتخزينها محلياً في متصفح المستخدم. التطبيق يتعامل بشكل أساسي مع هذه القاعدة المحلية، مما يجعله سريعاً جداً وقادراً على العمل دون إنترنت.
3.  **المزامنة الذكية (Smart Sync):**
    *   أي تغيير يقوم به المستخدم (مثل موافقة الشيف على طلب) يتم حفظه **فوراً** في قاعدة البيانات المحلية.
    *   يتم إضافة هذا التغيير إلى "قائمة انتظار المزامنة".
    *   يقوم **Service Worker** في الخلفية بمراقبة هذه القائمة. عند توفر اتصال بالإنترنت، يقوم بإرسال التغييرات المعلقة إلى Supabase لتحديث قاعدة البيانات السحابية.
4.  **التحديثات اللحظية (Realtime):** عندما يكون التطبيق متصلاً، فإنه يستمع للتغييرات المباشرة من Supabase (عبر Realtime Subscriptions) ويقوم بتحديث الواجهة وقاعدة البيانات المحلية فوراً لضمان أن جميع المستخدمين على نفس الصفحة.

### ب. تدفق تأكيد الطلب متعدد المستويات (درع أمان المطبخ)

لمنع الطلبات الوهمية أو غير الجادة، قمنا بتطبيق تدفق آمن ومحكم:
1.  **الزبون يرسل الطلب للموافقة:** بعد أن يختار الزبون أصنافه، يرسل الطلب. هذا الطلب لا يذهب مباشرة إلى المطبخ، بل يدخل في حالة "بانتظار الموافقة".
2.  **الشيف يوافق:** يظهر الطلب فوراً في واجهة الشيف. يقوم الشيف بمراجعته والتأكد من توفر المكونات، ثم يضغط "موافقة".
3.  **المحاسب يوافق:** بعد موافقة الشيف، يتغير لون بطاقة الطاولة في واجهة المدير/المحاسب، الذي يقوم بدوره بالموافقة المالية على الطلب.
4.  **الزبون يؤكد نهائياً:** تصل رسالة إلى الزبون تفيد بأن طلبه تمت الموافقة عليه. يجب على الزبون الآن الضغط على زر "تأكيد الطلب النهائي" لإرساله إلى المطبخ.
5.  **الطلب الآن مؤكد:** فقط بعد هذه الخطوات الأربع، يصبح الطلب "مؤكداً" ويظهر في قائمة التحضير لدى الشيف.

### ج. أدوار المستخدمين وواجهاتهم

1.  **واجهة الزبون (Customer Menu):**
    *   **وصول آمن:** يصل إليها الزبون عبر مسح رمز QR على طاولته.
    *   **قائمة طعام تفاعلية (Mobile-First):** يتصفح القائمة، يضيف للسلة، ويتبع خطوات "تدفق تأكيد الطلب".

2.  **واجهة الشيف (Chef UI):**
    *   **شاشة بنظام "كانبان" (Kanban):** تنقسم الواجهة إلى أعمدة واضحة: "طلبات بانتظار موافقتك" و "طلبات قيد التحضير".

3.  **واجهة المدير/المحاسب (Dashboard & POS):**
    *   **مركز التحكم الرئيسي:** يراقب المدير حالة الطاولات بشكل مباشر.
    *   **إدارة شاملة:** يمكنه إدارة قائمة الطعام، المصاريف، الموظفين، والاطلاع على التقارير.

---

## 4. التقنيات والمكتبات المستخدمة (The Tech Stack)

تم بناء المشروع على حزمة من أحدث التقنيات لضمان الأداء العالي، الجودة، وقابلية التوسع:

*   **لغة البرمجة:** **TypeScript**
*   **إطار العمل (Framework):** **Next.js (React)**
*   **قاعدة البيانات:** **Supabase (PostgreSQL)** مع **IndexedDB (Dexie.js)** للمزامنة.
*   **التصميم والواجهة (UI/Styling):**
    *   **Tailwind CSS**, **ShadCN UI**, **Framer Motion**, **Lucide React**
*   **الرسوم البيانية:** **Recharts**
*   **الذكاء الاصطناعي (AI):** **Genkit (من Google)**

---

هذه الوثيقة تمثل الرؤية الكاملة لمشروع "المائدة". نحن لا نبني تطبيقاً فحسب، بل نبني أساساً قوياً لمستقبل إدارة المطاعم الذكية.
